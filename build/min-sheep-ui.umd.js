(function(b,e){typeof exports=="object"&&typeof module<"u"?e(exports,require("vue")):typeof define=="function"&&define.amd?define(["exports","vue"],e):(b=typeof globalThis<"u"?globalThis:b||self,e(b.MinSheepUI={},b.Vue))})(this,function(b,e){"use strict";const $={type:{type:String,default:"secondary"},size:{type:String,default:"medium"},disabled:{type:Boolean,default:!1},block:{type:Boolean,default:!1}},ue="",pe="",C=e.defineComponent({name:"SButton",props:$,setup(n,{slots:t}){const{type:a,size:l,disabled:o,block:r}=e.toRefs(n),d=r.value?"s-btn--block":"";return()=>e.createVNode("button",{disabled:o.value,class:`s-btn s-btn--${a.value} s-btn--${l.value} ${d}`},[t.default?t.default():"按钮"])}}),R={install(n){n.component(C.name,C)}};function L(n,t=0,a=[]){return t++,n.reduce((l,o)=>{const r={...o};r.level=t,a.length>0&&a[a.length-1].level>=t&&a.pop(),a.push(r);const d=a[a.length-2];if(d&&(r.parentId=d.id),r.children){const c=L(r.children,t,a);return delete r.children,l.concat(r,c)}else return r.isLeaf===void 0&&(r.isLeaf=!0),l.concat(r)},[])}function F(n,{getChildren:t}){return{toggleCheckNode:l=>{l.checked=!l.checked,t(l).forEach(c=>{c.checked=l.checked});const o=n.value.find(c=>c.id===l.parentId);if(!o)return;const r=t(o,!1),d=r.filter(c=>c.checked);d.length===r.length?o.checked=!0:d.length===0&&(o.checked=!1)}}}function q(n){const t=e.computed(()=>{let c=[];const s=[];for(const u of n.value)c.map(i=>i.id).includes(u.id)||(u.expanded!==!0&&(c=a(u)),s.push(u));return s}),a=(c,s=!0)=>{const u=[],i=n.value.findIndex(m=>m.id===c.id);for(let m=i+1;m<n.value.length&&c.level<n.value[m].level;m++)(s||c.level===n.value[m].level-1)&&u.push(n.value[m]);return u},l=(c,s=[])=>{const u=a(c,!1);return s.push(...u),u.forEach(i=>{i.expanded&&l(i,s)}),s};return{expandedTree:t,getChildren:a,getChildrenExpanded:l,getIndex:c=>c?n.value.findIndex(s=>s.id===c.id):-1,getNode:c=>n.value.find(s=>s.id===c.id),getParent:c=>n.value.find(s=>s.id===c.parentId)}}const D={dropPrev:"s-tree__node--drop-prev",dropNext:"s-tree__node--drop-next",dropInner:"s-tree__node--drop-inner"};function U(n,t,{getChildren:a,getParent:l}){const o=e.reactive({dropType:void 0,draggingNode:null,draggingTreeNode:null}),r=e.computed(()=>t.value.reduce((p,f)=>({...p,[f.id]:f}),{})),d=p=>{p==null||p.classList.remove(...Object.values(D))},c=(p,f)=>{var h;const g=(h=r.value[p])==null?void 0:h.parentId;return g===f?!0:g!==void 0?c(g,f):!1},s=()=>{o.dropType=void 0,o.draggingNode=null,o.draggingTreeNode=null},u=(p,f)=>{var g;p.stopPropagation(),o.draggingNode=p.target,o.draggingTreeNode=f,(g=p.dataTransfer)==null||g.setData("dragNodeId",f.id)},i=p=>{if(p.preventDefault(),p.stopPropagation(),!!o.draggingNode&&n){if(p.dataTransfer&&(p.dataTransfer.dropEffect="move"),!t)return;let f={};typeof n=="object"?f=n:n===!0&&(f={dropInner:!0});const{dropPrev:g,dropNext:h,dropInner:v}=f;let N;const y=g?v?.25:h?.45:1:-1,V=h?v?.75:g?.55:0:1,P=p.currentTarget,T=P==null?void 0:P.getBoundingClientRect(),A=p.clientY-((T==null?void 0:T.top)||0);if(A<((T==null?void 0:T.height)||0)*y?N="dropPrev":A>((T==null?void 0:T.height)||0)*V?N="dropNext":v?N="dropInner":N=void 0,N){const O=P==null?void 0:P.classList;O&&(O.contains(D[N])||(d(P),O.add(D[N])))}else d(P);o.dropType=N}},m=p=>{p.stopPropagation(),o.draggingNode&&d(p.currentTarget)},x=(p,f)=>{var h;if(p.preventDefault(),p.stopPropagation(),d(p.currentTarget),!o.draggingNode||!n)return;const g=(h=p.dataTransfer)==null?void 0:h.getData("dragNodeId");if(g){const v=c(f.id,g);if(g===f.id||v)return;o.dropType&&I(g,f),s()}};function I(p,f){const g=t.value.find(h=>h.id===p);if(g){let h;const v=a(g),N=l(g);if(o.dropType==="dropInner"){h={...g,parentId:f.id,level:f.level+1};const y=t.value.indexOf(f);t.value.splice(y+1,0,h),f.isLeaf=void 0;const V=t.value.indexOf(g);t.value.splice(V,1)}else if(o.dropType==="dropNext"){h={...g,parentId:f.parentId,level:f.level};const y=t.value.indexOf(f),V=a(f,!0).length;t.value.splice(y+V+1,0,h);const P=t.value.indexOf(g);t.value.splice(P,1)}else if(o.dropType==="dropPrev"){h={...g,parentId:f.parentId,level:f.level};const y=t.value.indexOf(f);t.value.splice(y,0,h);const V=t.value.indexOf(g);t.value.splice(V,1)}o.dropType="dropInner",v.forEach(y=>I(y.id,h)),N&&a(N).length===0&&(N.isLeaf=!0)}}return{onDragstart:u,onDragover:i,onDragleave:m,onDrop:x,onDragend:p=>{p.preventDefault(),p.stopPropagation(),s()}}}function Y(n,{getNode:t,getIndex:a,getChildren:l},{emit:o}){const r=u=>{const i=t(u);i&&i.isLeaf===!1&&!i.childNodeCount&&(i.loading=!0,o("lazy-load",u,d))},d=u=>{const i=t(u.node);if(i){i.loading=!1;const m=e.ref(L(u.treeItems,i.level));c(i,m),s(i,m);const x=l(i);i.childNodeCount=x.length}},c=(u,i)=>{i.value.forEach(m=>{m.level-1===u.level&&!m.parentId&&(m.parentId=u.id)})},s=(u,i)=>{const m=a(u);m&&n.value.splice(m+1,0,...i.value)};return{lazyLoadNodes:r}}function G(n=8){const t="abcdefghijklmnopqrstuvwxyz0123456789";let a="";for(let l=0;l<n;l++)a+=t[parseInt((Math.random()*t.length).toString())];return a}function J(n,{getChildren:t,getIndex:a}){return{append:(r,d)=>{const c=t(r,!1),s=c[c.length-1];let u=a(r)+1;s&&(u=a(s)+1),r.expanded=!0,r.isLeaf=!1;const i=e.ref({...d,level:r.level+1,parentId:r.id,isLeaf:!0});i.value.id===void 0&&(i.value.id=G()),n.value.splice(u,0,i.value)},remove:r=>{const d=t(r).map(c=>c.id);n.value=n.value.filter(c=>c.id!==r.id&&!d.includes(c.id))}}}function K(n,t,a,l){const{lazyLoadNodes:o}=l;return{toggleNode:d=>{const c=n.value.find(s=>s.id===d.id);c&&(c.expanded=!c.expanded,c.expanded&&o(c))}}}function Q(n,t,a){const l=e.unref(n),o=e.ref(L(l)),r=q(o),d=[K,F,J],c=Y(o,r,a),s=U(t.draggable,o,r);return{...d.reduce((i,m)=>({...i,...m(o,r,a,c)}),{}),...r,...s,treeData:o}}const w={data:{type:Object,required:!0},lineable:{type:Boolean,default:!1},checkable:{type:Boolean,default:!1},operable:{type:Boolean,default:!1},draggable:{type:[Boolean,Object],default:!1},height:{type:Number},itemHeight:{type:Number,default:30}},W={...w,treeNode:{type:Object,required:!0}},z=32,B=24,X=e.defineComponent({name:"STreeNode",props:W,setup(n,{slots:t}){const{lineable:a,checkable:l,treeNode:o,operable:r,draggable:d}=e.toRefs(n),{toggleCheckNode:c,getChildrenExpanded:s,append:u,remove:i,onDragend:m,onDragleave:x,onDragover:I,onDragstart:k,onDrop:p}=e.inject("TREE_UTILS"),f=e.ref(!1),g=()=>{f.value?f.value=!1:f.value=!0};let h={};return d.value&&(h={draggable:!0,onDragend:v=>m(v),onDragleave:v=>x(v),onDragover:v=>I(v),onDragstart:v=>k(v,o.value),onDrop:v=>p(v,o.value)}),()=>{var v,N,y;return e.createVNode("div",{class:"s-tree__node hover:bg-slate-300 relative leading-8",style:{paddingLeft:`${B*(o.value.level-1)}px`},onMouseenter:g,onMouseleave:g},[!o.value.isLeaf&&o.value.expanded&&a.value&&e.createVNode("span",{class:"s-tree-node__vline absolute w-px bg-slate-300",style:{height:`${z*s(o.value).length}px`,left:`${B*(o.value.level-1)+9}px`,top:`${z}px`}},null),e.createVNode("div",e.mergeProps({class:"s-tree__node--content"},h),[o.value.isLeaf?e.createVNode("span",{style:{display:"inline-block",width:"18px"}},null):(v=t.icon)==null?void 0:v.call(t),l.value&&e.withDirectives(e.createVNode("input",{type:"checkbox","onUpdate:modelValue":V=>o.value.checked=V,onClick:()=>{c(o.value)}},null),[[e.vModelCheckbox,o.value.checked]]),(N=t.content)==null?void 0:N.call(t),r.value&&f.value&&e.createVNode("span",{class:"inline-flex ml-1"},[e.createVNode("svg",{onClick:()=>{u(o.value,{label:"新节点"})},viewBox:"0 0 1024 1024",width:"14",height:"14",class:"cursor-pointer"},[e.createVNode("path",{d:"M590.769231 571.076923h324.923077c15.753846 0 29.538462-13.784615 29.538461-29.538461v-59.076924c0-15.753846-13.784615-29.538462-29.538461-29.538461H590.769231c-11.815385 0-19.692308-7.876923-19.692308-19.692308V108.307692c0-15.753846-13.784615-29.538462-29.538461-29.538461h-59.076924c-15.753846 0-29.538462 13.784615-29.538461 29.538461V433.230769c0 11.815385-7.876923 19.692308-19.692308 19.692308H108.307692c-15.753846 0-29.538462 13.784615-29.538461 29.538461v59.076924c0 15.753846 13.784615 29.538462 29.538461 29.538461H433.230769c11.815385 0 19.692308 7.876923 19.692308 19.692308v324.923077c0 15.753846 13.784615 29.538462 29.538461 29.538461h59.076924c15.753846 0 29.538462-13.784615 29.538461-29.538461V590.769231c0-11.815385 7.876923-19.692308 19.692308-19.692308z"},null)]),e.createVNode("svg",{onClick:()=>{i(o.value)},viewBox:"0 0 1024 1024",width:"14",height:"14",class:"cursor-pointer ml-1"},[e.createVNode("path",{d:"M610.461538 500.184615l256-257.96923c11.815385-11.815385 11.815385-29.538462 0-41.353847l-39.384615-41.353846c-11.815385-11.815385-29.538462-11.815385-41.353846 0L527.753846 417.476923c-7.876923 7.876923-19.692308 7.876923-27.569231 0L242.215385 157.538462c-11.815385-11.815385-29.538462-11.815385-41.353847 0l-41.353846 41.353846c-11.815385 11.815385-11.815385 29.538462 0 41.353846l257.969231 257.969231c7.876923 7.876923 7.876923 19.692308 0 27.56923L157.538462 785.723077c-11.815385 11.815385-11.815385 29.538462 0 41.353846l41.353846 41.353846c11.815385 11.815385 29.538462 11.815385 41.353846 0L498.215385 610.461538c7.876923-7.876923 19.692308-7.876923 27.56923 0l257.969231 257.969231c11.815385 11.815385 29.538462 11.815385 41.353846 0L866.461538 827.076923c11.815385-11.815385 11.815385-29.538462 0-41.353846L610.461538 527.753846c-7.876923-7.876923-7.876923-19.692308 0-27.569231z"},null)])]),o.value.loading&&((y=t.loading)==null?void 0:y.call(t))])])}}}),Z=(n,{emit:t})=>e.createVNode("svg",{style:{width:"18px",height:"18px",display:"inline-block",transform:n.expanded?"rotate(90deg)":""},viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg",onClick:()=>t("onClick")},[e.createVNode("path",{fill:"currentColor",d:"M384 192v640l384-320.064z"},null)]),fe="",ee={data:{type:Array,default:[]},itemHeight:{type:Number,default:22},component:{type:String,default:"div"}},ge="",te=e.defineComponent({name:"SVirtualList",props:ee,setup(n,{slots:t}){const{data:a,itemHeight:l,component:o}=e.toRefs(n),r=e.ref(),d=e.ref(0),c=e.ref(0),s=e.ref(0),u=e.computed(()=>Math.ceil(d.value/l.value)),i=e.computed(()=>a.value.slice(s.value,Math.min(s.value+u.value,a.value.length)));e.onMounted(()=>{var x;d.value=(x=r.value)==null?void 0:x.clientHeight});const m=x=>{const{scrollTop:I}=x.target;s.value=Math.floor(I/l.value),c.value=I-I%l.value};return()=>e.createVNode(o.value,{class:"s-virtual-list__container",ref:r,onScroll:m},{default:()=>[e.createVNode("div",{class:"s-virtual-list__blank",style:{height:`${a.value.length*l.value}px`}},null),e.createVNode("div",{class:"s-virtual-list",style:{transform:`translate3d(0, ${c.value}px, 0)`}},[i.value.map((x,I)=>{var k;return(k=t.default)==null?void 0:k.call(t,{item:x,index:I})})])]})}}),_=e.defineComponent({name:"STree",props:w,emits:["lazy-load"],setup(n,t){const{data:a,height:l,itemHeight:o}=e.toRefs(n),{slots:r}=t,d=Q(a,n,t);return e.provide("TREE_UTILS",d),()=>{const c=s=>e.createVNode(X,e.mergeProps(n,{treeNode:s}),{content:()=>r.content?r.content(s):s.label,icon:()=>r.icon?r.icon({nodeData:s,toggleNode:d.toggleNode}):e.createVNode(Z,{expanded:!!s.expanded,onClick:()=>d.toggleNode(s)},null),loading:()=>r.loading?r.loading({nodeData:d}):e.createVNode("span",{class:"ml-1"},[e.createTextVNode("loading...")])});return e.createVNode("div",{class:"s-tree"},[l!=null&&l.value?e.createVNode("div",{style:{height:`${l.value}px`}},[e.createVNode(te,{data:d.expandedTree.value,itemHeight:o.value},{default:({item:s})=>c(s)})]):d.expandedTree.value.map(s=>c(s))])}}}),ne={install(n){n.component(_.name,_)}},j={total:{type:Number,default:0},pageSize:{type:Number,default:10},pagerCount:{type:Number,default:7},modelValue:{type:Number,default:1}},me="";function oe(n=1){const t=e.ref(n),a=d=>{t.value=d},l=d=>{t.value+=d};return{pageIndex:t,setPageIndex:a,jumpPage:l,prevPage:()=>l(-1),nextPage:()=>l(1)}}const ae=(n,t,a)=>{const l=Array.from(Array(n).keys());if(n<=a)return l.slice(2,n);{const o=Math.ceil(a/2);return t<=o?l.slice(2,a):t>=n-o+1?l.slice(n-a+2,n):l.slice(t-o+2,t+o-1)}},le=j,S=e.defineComponent({name:"SPager",props:le,setup(n){const{total:t,pageSize:a,pagerCount:l}=e.toRefs(n),o=e.computed(()=>Math.ceil(t.value/a.value)),{pageIndex:r,setPageIndex:d,jumpPage:c,prevPage:s,nextPage:u}=oe(),i=e.computed(()=>ae(o.value,r.value,l.value));return{totalPage:o,pageIndex:r,setPageIndex:d,jumpPage:c,prevPage:s,nextPage:u,centerPages:i}},render(){const{pagerCount:n,totalPage:t,pageIndex:a,setPageIndex:l,jumpPage:o,centerPages:r}=this;return e.createVNode("ul",{class:"s-pager"},[e.createVNode("li",{onClick:()=>l(1),class:{current:a===1}},[e.createTextVNode("1")]),t>n&&a>Math.ceil(n/2)&&e.createVNode("li",{class:"more left",onClick:()=>o(-5)},[e.createTextVNode("...")]),r.map(d=>e.createVNode("li",{onClick:()=>l(d),class:{current:a===d}},[d])),t>n&&a<t-Math.ceil(n/2)+1&&e.createVNode("li",{class:"more right",onClick:()=>o(5)},[e.createTextVNode("...")]),t>1&&e.createVNode("li",{onClick:()=>l(t),class:{current:a===t}},[t])])}}),E=e.defineComponent({name:"SPagination",props:j,emits:["update:modelValue"],setup(n,{emit:t}){const a=e.ref(),l=e.computed(()=>a.value?a.value.pageIndex<2:!0),o=e.computed(()=>a.value?a.value.pageIndex>a.value.totalPage-1:!0);return e.onMounted(()=>{e.watch(()=>a.value.pageIndex,r=>{t("update:modelValue",r)}),e.watch(()=>n.modelValue,r=>{a.value.pageIndex=r})}),()=>e.createVNode("div",{class:"s-pagination"},[e.createVNode("button",{disabled:l.value,onClick:()=>a.value.prevPage()},[e.createTextVNode("上一页")]),e.createVNode(S,e.mergeProps(n,{ref:a}),null),e.createVNode("button",{disabled:o.value,onClick:()=>a.value.nextPage()},[e.createTextVNode("下一页")])])}}),re={install(n){n.component(E.name,E),n.component(S.name,S)}},ce={model:{type:Object,required:!0},layout:{type:String,default:"horizontal"}},he="",M=e.defineComponent({name:"SForm",props:ce,setup(n,{slots:t}){const a=e.computed(()=>({layout:n.layout}));return e.provide("LABEL_DATA",a),()=>{var l;return e.createVNode("div",{class:"s-form"},[(l=t.default)==null?void 0:l.call(t)])}}}),de={label:{type:String}},ve="",H=e.defineComponent({name:"SFormItem",props:de,setup(n,{slots:t}){const a=e.inject("LABEL_DATA"),l=e.computed(()=>({"s-form__item":!0,"s-form__item--horizontal":a.value.layout==="horizontal","s-form__item--vertical":a.value.layout==="vertical"}));return()=>{var o;return e.createVNode("div",{class:l.value},[e.createVNode("span",{class:"s-form__label"},[n.label]),e.createVNode("div",null,[(o=t.default)==null?void 0:o.call(t)])])}}}),se=[R,ne,re,{install(n){n.component(M.name,M),n.component(H.name,H)}}],ie={version:"0.0.1",install(n){se.forEach(t=>n.use(t))}};b.Button=C,b.Form=M,b.Pagination=E,b.Tree=_,b.default=ie,Object.defineProperties(b,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
