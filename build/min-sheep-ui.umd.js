(function(p,o){typeof exports=="object"&&typeof module<"u"?o(exports,require("vue")):typeof define=="function"&&define.amd?define(["exports","vue"],o):(p=typeof globalThis<"u"?globalThis:p||self,o(p["min-sheep-ui"]={},p.Vue))})(this,function(p,o){"use strict";const C={type:{type:String,default:"secondary"},size:{type:String,default:"medium"},disabled:{type:Boolean,default:!1},block:{type:Boolean,default:!1}},H="",g=o.defineComponent({name:"SButton",props:C,setup(t,{slots:e}){const{type:i,size:a,disabled:c,block:d}=o.toRefs(t),n=d.value?"s-btn--block":"";return()=>o.createVNode("button",{disabled:c.value,class:`s-btn s-btn--${i.value} s-btn--${a.value} ${n}`},[e.default?e.default():"按钮"])}}),T={install(t){t.component(g.name,g)}};function v(t,e=0,i=[]){return e++,t.reduce((a,c)=>{const d={...c};d.level=e,i.length>0&&i[i.length-1].level>=e&&i.pop(),i.push(d);const n=i[i.length-2];if(n&&(d.parentId=n.id),d.children){const l=v(d.children,e,i);return delete d.children,a.concat(d,l)}else return d.isLeaf===void 0&&(d.isLeaf=!0),a.concat(d)},[])}function V(t,{getChildren:e}){return{toggleCheckNode:a=>{a.checked=!a.checked,e(a).forEach(l=>{l.checked=a.checked});const c=t.value.find(l=>l.id===a.parentId);if(!c)return;const d=e(c,!1),n=d.filter(l=>l.checked);n.length===d.length?c.checked=!0:n.length===0&&(c.checked=!1)}}}function I(t){const e=o.computed(()=>{let n=[];const l=[];for(const u of t.value)n.map(r=>r.id).includes(u.id)||(u.expanded!==!0&&(n=i(u)),l.push(u));return l}),i=(n,l=!0)=>{const u=[],r=t.value.findIndex(s=>s.id===n.id);for(let s=r+1;s<t.value.length&&n.level<t.value[s].level;s++)(l||n.level===t.value[s].level-1)&&u.push(t.value[s]);return u},a=(n,l=[])=>{const u=i(n,!1);return l.push(...u),u.forEach(r=>{r.expanded&&a(r,l)}),l};return{expandedTree:e,getChildren:i,getChildrenExpanded:a,getIndex:n=>n?t.value.findIndex(l=>l.id===n.id):-1,getNode:n=>t.value.find(l=>l.id===n.id)}}function L(t,{getNode:e,getIndex:i,getChildren:a},{emit:c}){const d=r=>{const s=e(r);s&&s.isLeaf===!1&&!s.childNodeCount&&(s.loading=!0,c("lazy-load",r,n))},n=r=>{const s=e(r.node);if(s){s.loading=!1;const f=o.ref(v(r.treeItems,s.level));l(s,f),u(s,f);const h=a(s);s.childNodeCount=h.length}},l=(r,s)=>{s.value.forEach(f=>{f.level-1===r.level&&!f.parentId&&(f.parentId=r.id)})},u=(r,s)=>{const f=i(r);f&&t.value.splice(f+1,0,...s.value)};return{lazyLoadNodes:d}}function w(t=8){const e="abcdefghijklmnopqrstuvwxyz0123456789";let i="";for(let a=0;a<t;a++)i+=e[parseInt((Math.random()*e.length).toString())];return i}function E(t,{getChildren:e,getIndex:i}){return{append:(d,n)=>{const l=e(d,!1),u=l[l.length-1];let r=i(d)+1;u&&(r=i(u)+1),d.expanded=!0,d.isLeaf=!1;const s=o.ref({...n,level:d.level+1,parentId:d.id,isLeaf:!0});s.value.id===void 0&&(s.value.id=w()),t.value.splice(r,0,s.value)},remove:d=>{const n=e(d).map(l=>l.id);t.value=t.value.filter(l=>l.id!==d.id&&!n.includes(l.id))}}}function S(t,e,i,a){const{lazyLoadNodes:c}=a;return{toggleNode:n=>{const l=t.value.find(u=>u.id===n.id);l&&(l.expanded=!l.expanded,l.expanded&&c(l))}}}function z(t,e){const i=o.unref(t),a=o.ref(v(i)),c=I(a),d=[S,V,E],n=L(a,c,e);return{...d.reduce((u,r)=>({...u,...r(a,c,e,n)}),{}),...c,treeData:a}}const x={data:{type:Object,required:!0},lineable:{type:Boolean,default:!1},checkable:{type:Boolean,default:!1},operable:{type:Boolean,default:!1}},B={...x,treeNode:{type:Object,required:!0}},b=32,m=24,M=o.defineComponent({name:"STreeNode",props:B,setup(t,{slots:e}){const{lineable:i,checkable:a,treeNode:c,operable:d}=o.toRefs(t),{toggleCheckNode:n,getChildrenExpanded:l,append:u,remove:r}=o.inject("TREE_UTILS"),s=o.ref(!1),f=()=>{s.value?s.value=!1:s.value=!0};return()=>{var h,k,y;return o.createVNode("div",{class:"s-tree-node hover:bg-slate-300 relative leading-8",style:{paddingLeft:`${m*(c.value.level-1)}px`},onMouseenter:f,onMouseleave:f},[!c.value.isLeaf&&c.value.expanded&&i.value&&o.createVNode("span",{class:"s-tree-node__vline absolute w-px bg-slate-300",style:{height:`${b*l(c.value).length}px`,left:`${m*(c.value.level-1)+9}px`,top:`${b}px`}},null),c.value.isLeaf?o.createVNode("span",{style:{display:"inline-block",width:"18px"}},null):(h=e.icon)==null?void 0:h.call(e),a.value&&o.withDirectives(o.createVNode("input",{type:"checkbox","onUpdate:modelValue":j=>c.value.checked=j,onClick:()=>{n(c.value)}},null),[[o.vModelCheckbox,c.value.checked]]),(k=e.content)==null?void 0:k.call(e),d.value&&s.value&&o.createVNode("span",{class:"inline-flex ml-1"},[o.createVNode("svg",{onClick:()=>{u(c.value,{label:"新节点"})},viewBox:"0 0 1024 1024",width:"14",height:"14",class:"cursor-pointer"},[o.createVNode("path",{d:"M590.769231 571.076923h324.923077c15.753846 0 29.538462-13.784615 29.538461-29.538461v-59.076924c0-15.753846-13.784615-29.538462-29.538461-29.538461H590.769231c-11.815385 0-19.692308-7.876923-19.692308-19.692308V108.307692c0-15.753846-13.784615-29.538462-29.538461-29.538461h-59.076924c-15.753846 0-29.538462 13.784615-29.538461 29.538461V433.230769c0 11.815385-7.876923 19.692308-19.692308 19.692308H108.307692c-15.753846 0-29.538462 13.784615-29.538461 29.538461v59.076924c0 15.753846 13.784615 29.538462 29.538461 29.538461H433.230769c11.815385 0 19.692308 7.876923 19.692308 19.692308v324.923077c0 15.753846 13.784615 29.538462 29.538461 29.538461h59.076924c15.753846 0 29.538462-13.784615 29.538461-29.538461V590.769231c0-11.815385 7.876923-19.692308 19.692308-19.692308z"},null)]),o.createVNode("svg",{onClick:()=>{r(c.value)},viewBox:"0 0 1024 1024",width:"14",height:"14",class:"cursor-pointer ml-1"},[o.createVNode("path",{d:"M610.461538 500.184615l256-257.96923c11.815385-11.815385 11.815385-29.538462 0-41.353847l-39.384615-41.353846c-11.815385-11.815385-29.538462-11.815385-41.353846 0L527.753846 417.476923c-7.876923 7.876923-19.692308 7.876923-27.569231 0L242.215385 157.538462c-11.815385-11.815385-29.538462-11.815385-41.353847 0l-41.353846 41.353846c-11.815385 11.815385-11.815385 29.538462 0 41.353846l257.969231 257.969231c7.876923 7.876923 7.876923 19.692308 0 27.56923L157.538462 785.723077c-11.815385 11.815385-11.815385 29.538462 0 41.353846l41.353846 41.353846c11.815385 11.815385 29.538462 11.815385 41.353846 0L498.215385 610.461538c7.876923-7.876923 19.692308-7.876923 27.56923 0l257.969231 257.969231c11.815385 11.815385 29.538462 11.815385 41.353846 0L866.461538 827.076923c11.815385-11.815385 11.815385-29.538462 0-41.353846L610.461538 527.753846c-7.876923-7.876923-7.876923-19.692308 0-27.569231z"},null)])]),c.value.loading&&((y=e.loading)==null?void 0:y.call(e))])}}}),P=(t,{emit:e})=>o.createVNode("svg",{style:{width:"18px",height:"18px",display:"inline-block",transform:t.expanded?"rotate(90deg)":""},viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg",onClick:()=>e("onClick")},[o.createVNode("path",{fill:"currentColor",d:"M384 192v640l384-320.064z"},null)]),R="",N=o.defineComponent({name:"STree",props:x,emits:["lazy-load"],setup(t,e){const{data:i}=o.toRefs(t),{slots:a}=e,c=z(i,e);return o.provide("TREE_UTILS",c),()=>{var d;return o.createVNode("div",{class:"s-tree"},[(d=c.expandedTree)==null?void 0:d.value.map(n=>o.createVNode(M,o.mergeProps(t,{treeNode:n}),{content:()=>a.content?a.content(n):n.label,icon:()=>a.icon?a.icon({nodeData:n,toggleNode:c.toggleNode}):o.createVNode(P,{expanded:!!n.expanded,onClick:()=>c.toggleNode(n)},null),loading:()=>a.loading?a.loading({nodeData:c}):o.createVNode("span",{class:"ml-1"},[o.createTextVNode("loading...")])}))])}}}),_={install(t){t.component(N.name,N)}},q="",O=[T,_],$={version:"0.0.1",install(t){O.forEach(e=>t.use(e))}};p.Button=g,p.Tree=N,p.default=$,Object.defineProperties(p,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
