(function(y,e){typeof exports=="object"&&typeof module<"u"?e(exports,require("vue")):typeof define=="function"&&define.amd?define(["exports","vue"],e):(y=typeof globalThis<"u"?globalThis:y||self,e(y.MinSheepUI={},y.Vue))})(this,function(y,e){"use strict";const $={type:{type:String,default:"secondary"},size:{type:String,default:"medium"},disabled:{type:Boolean,default:!1},block:{type:Boolean,default:!1}},ue="",pe="",C=e.defineComponent({name:"SButton",props:$,setup(n,{slots:t}){const{type:o,size:r,disabled:l,block:a}=e.toRefs(n),d=a.value?"s-btn--block":"";return()=>e.createVNode("button",{disabled:l.value,class:`s-btn s-btn--${o.value} s-btn--${r.value} ${d}`},[t.default?t.default():"按钮"])}}),R={install(n){n.component(C.name,C)}};function _(n,t=0,o=[]){return t++,n.reduce((r,l)=>{const a={...l};a.level=t,o.length>0&&o[o.length-1].level>=t&&o.pop(),o.push(a);const d=o[o.length-2];if(d&&(a.parentId=d.id),a.children){const c=_(a.children,t,o);return delete a.children,r.concat(a,c)}else return a.isLeaf===void 0&&(a.isLeaf=!0),r.concat(a)},[])}function F(n,{getChildren:t}){return{toggleCheckNode:r=>{r.checked=!r.checked,t(r).forEach(c=>{c.checked=r.checked});const l=n.value.find(c=>c.id===r.parentId);if(!l)return;const a=t(l,!1),d=a.filter(c=>c.checked);d.length===a.length?l.checked=!0:d.length===0&&(l.checked=!1)}}}function q(n){const t=e.computed(()=>{let c=[];const i=[];for(const u of n.value)c.map(s=>s.id).includes(u.id)||(u.expanded!==!0&&(c=o(u)),i.push(u));return i}),o=(c,i=!0)=>{const u=[],s=n.value.findIndex(m=>m.id===c.id);for(let m=s+1;m<n.value.length&&c.level<n.value[m].level;m++)(i||c.level===n.value[m].level-1)&&u.push(n.value[m]);return u},r=(c,i=[])=>{const u=o(c,!1);return i.push(...u),u.forEach(s=>{s.expanded&&r(s,i)}),i};return{expandedTree:t,getChildren:o,getChildrenExpanded:r,getIndex:c=>c?n.value.findIndex(i=>i.id===c.id):-1,getNode:c=>n.value.find(i=>i.id===c.id),getParent:c=>n.value.find(i=>i.id===c.parentId)}}const S={dropPrev:"s-tree__node--drop-prev",dropNext:"s-tree__node--drop-next",dropInner:"s-tree__node--drop-inner"};function U(n,t,{getChildren:o,getParent:r}){const l=e.reactive({dropType:void 0,draggingNode:null,draggingTreeNode:null}),a=e.computed(()=>t.value.reduce((p,f)=>({...p,[f.id]:f}),{})),d=p=>{p==null||p.classList.remove(...Object.values(S))},c=(p,f)=>{var h;const g=(h=a.value[p])==null?void 0:h.parentId;return g===f?!0:g!==void 0?c(g,f):!1},i=()=>{l.dropType=void 0,l.draggingNode=null,l.draggingTreeNode=null},u=(p,f)=>{var g;p.stopPropagation(),l.draggingNode=p.target,l.draggingTreeNode=f,(g=p.dataTransfer)==null||g.setData("dragNodeId",f.id)},s=p=>{if(p.preventDefault(),p.stopPropagation(),!!l.draggingNode&&n){if(p.dataTransfer&&(p.dataTransfer.dropEffect="move"),!t)return;let f={};typeof n=="object"?f=n:n===!0&&(f={dropInner:!0});const{dropPrev:g,dropNext:h,dropInner:v}=f;let N;const x=g?v?.25:h?.45:1:-1,V=h?v?.75:g?.55:0:1,P=p.currentTarget,T=P==null?void 0:P.getBoundingClientRect(),H=p.clientY-((T==null?void 0:T.top)||0);if(H<((T==null?void 0:T.height)||0)*x?N="dropPrev":H>((T==null?void 0:T.height)||0)*V?N="dropNext":v?N="dropInner":N=void 0,N){const M=P==null?void 0:P.classList;M&&(M.contains(S[N])||(d(P),M.add(S[N])))}else d(P);l.dropType=N}},m=p=>{p.stopPropagation(),l.draggingNode&&d(p.currentTarget)},b=(p,f)=>{var h;if(p.preventDefault(),p.stopPropagation(),d(p.currentTarget),!l.draggingNode||!n)return;const g=(h=p.dataTransfer)==null?void 0:h.getData("dragNodeId");if(g){const v=c(f.id,g);if(g===f.id||v)return;l.dropType&&I(g,f),i()}};function I(p,f){const g=t.value.find(h=>h.id===p);if(g){let h;const v=o(g),N=r(g);if(l.dropType==="dropInner"){h={...g,parentId:f.id,level:f.level+1};const x=t.value.indexOf(f);t.value.splice(x+1,0,h),f.isLeaf=void 0;const V=t.value.indexOf(g);t.value.splice(V,1)}else if(l.dropType==="dropNext"){h={...g,parentId:f.parentId,level:f.level};const x=t.value.indexOf(f),V=o(f,!0).length;t.value.splice(x+V+1,0,h);const P=t.value.indexOf(g);t.value.splice(P,1)}else if(l.dropType==="dropPrev"){h={...g,parentId:f.parentId,level:f.level};const x=t.value.indexOf(f);t.value.splice(x,0,h);const V=t.value.indexOf(g);t.value.splice(V,1)}l.dropType="dropInner",v.forEach(x=>I(x.id,h)),N&&o(N).length===0&&(N.isLeaf=!0)}}return{onDragstart:u,onDragover:s,onDragleave:m,onDrop:b,onDragend:p=>{p.preventDefault(),p.stopPropagation(),i()}}}function Y(n,{getNode:t,getIndex:o,getChildren:r},{emit:l}){const a=u=>{const s=t(u);s&&s.isLeaf===!1&&!s.childNodeCount&&(s.loading=!0,l("lazy-load",u,d))},d=u=>{const s=t(u.node);if(s){s.loading=!1;const m=e.ref(_(u.treeItems,s.level));c(s,m),i(s,m);const b=r(s);s.childNodeCount=b.length}},c=(u,s)=>{s.value.forEach(m=>{m.level-1===u.level&&!m.parentId&&(m.parentId=u.id)})},i=(u,s)=>{const m=o(u);m&&n.value.splice(m+1,0,...s.value)};return{lazyLoadNodes:a}}function G(n=8){const t="abcdefghijklmnopqrstuvwxyz0123456789";let o="";for(let r=0;r<n;r++)o+=t[parseInt((Math.random()*t.length).toString())];return o}function J(n,{getChildren:t,getIndex:o}){return{append:(a,d)=>{const c=t(a,!1),i=c[c.length-1];let u=o(a)+1;i&&(u=o(i)+1),a.expanded=!0,a.isLeaf=!1;const s=e.ref({...d,level:a.level+1,parentId:a.id,isLeaf:!0});s.value.id===void 0&&(s.value.id=G()),n.value.splice(u,0,s.value)},remove:a=>{const d=t(a).map(c=>c.id);n.value=n.value.filter(c=>c.id!==a.id&&!d.includes(c.id))}}}function K(n,t,o,r){const{lazyLoadNodes:l}=r;return{toggleNode:d=>{const c=n.value.find(i=>i.id===d.id);c&&(c.expanded=!c.expanded,c.expanded&&l(c))}}}function Q(n,t,o){const r=e.unref(n),l=e.ref(_(r)),a=q(l),d=[K,F,J],c=Y(l,a,o),i=U(t.draggable,l,a);return{...d.reduce((s,m)=>({...s,...m(l,a,o,c)}),{}),...a,...i,treeData:l}}const O={data:{type:Object,required:!0},lineable:{type:Boolean,default:!1},checkable:{type:Boolean,default:!1},operable:{type:Boolean,default:!1},draggable:{type:[Boolean,Object],default:!1},height:{type:Number},itemHeight:{type:Number,default:30}},W={...O,treeNode:{type:Object,required:!0}},w=32,B=24,X=e.defineComponent({name:"STreeNode",props:W,setup(n,{slots:t}){const{lineable:o,checkable:r,treeNode:l,operable:a,draggable:d}=e.toRefs(n),{toggleCheckNode:c,getChildrenExpanded:i,append:u,remove:s,onDragend:m,onDragleave:b,onDragover:I,onDragstart:k,onDrop:p}=e.inject("TREE_UTILS"),f=e.ref(!1),g=()=>{f.value?f.value=!1:f.value=!0};let h={};return d.value&&(h={draggable:!0,onDragend:v=>m(v),onDragleave:v=>b(v),onDragover:v=>I(v),onDragstart:v=>k(v,l.value),onDrop:v=>p(v,l.value)}),()=>{var v,N,x;return e.createVNode("div",{class:"s-tree__node hover:bg-slate-300 relative leading-8",style:{paddingLeft:`${B*(l.value.level-1)}px`},onMouseenter:g,onMouseleave:g},[!l.value.isLeaf&&l.value.expanded&&o.value&&e.createVNode("span",{class:"s-tree-node__vline absolute w-px bg-slate-300",style:{height:`${w*i(l.value).length}px`,left:`${B*(l.value.level-1)+9}px`,top:`${w}px`}},null),e.createVNode("div",e.mergeProps({class:"s-tree__node--content"},h),[l.value.isLeaf?e.createVNode("span",{style:{display:"inline-block",width:"18px"}},null):(v=t.icon)==null?void 0:v.call(t),r.value&&e.withDirectives(e.createVNode("input",{type:"checkbox","onUpdate:modelValue":V=>l.value.checked=V,onClick:()=>{c(l.value)}},null),[[e.vModelCheckbox,l.value.checked]]),(N=t.content)==null?void 0:N.call(t),a.value&&f.value&&e.createVNode("span",{class:"inline-flex ml-1"},[e.createVNode("svg",{onClick:()=>{u(l.value,{label:"新节点"})},viewBox:"0 0 1024 1024",width:"14",height:"14",class:"cursor-pointer"},[e.createVNode("path",{d:"M590.769231 571.076923h324.923077c15.753846 0 29.538462-13.784615 29.538461-29.538461v-59.076924c0-15.753846-13.784615-29.538462-29.538461-29.538461H590.769231c-11.815385 0-19.692308-7.876923-19.692308-19.692308V108.307692c0-15.753846-13.784615-29.538462-29.538461-29.538461h-59.076924c-15.753846 0-29.538462 13.784615-29.538461 29.538461V433.230769c0 11.815385-7.876923 19.692308-19.692308 19.692308H108.307692c-15.753846 0-29.538462 13.784615-29.538461 29.538461v59.076924c0 15.753846 13.784615 29.538462 29.538461 29.538461H433.230769c11.815385 0 19.692308 7.876923 19.692308 19.692308v324.923077c0 15.753846 13.784615 29.538462 29.538461 29.538461h59.076924c15.753846 0 29.538462-13.784615 29.538461-29.538461V590.769231c0-11.815385 7.876923-19.692308 19.692308-19.692308z"},null)]),e.createVNode("svg",{onClick:()=>{s(l.value)},viewBox:"0 0 1024 1024",width:"14",height:"14",class:"cursor-pointer ml-1"},[e.createVNode("path",{d:"M610.461538 500.184615l256-257.96923c11.815385-11.815385 11.815385-29.538462 0-41.353847l-39.384615-41.353846c-11.815385-11.815385-29.538462-11.815385-41.353846 0L527.753846 417.476923c-7.876923 7.876923-19.692308 7.876923-27.569231 0L242.215385 157.538462c-11.815385-11.815385-29.538462-11.815385-41.353847 0l-41.353846 41.353846c-11.815385 11.815385-11.815385 29.538462 0 41.353846l257.969231 257.969231c7.876923 7.876923 7.876923 19.692308 0 27.56923L157.538462 785.723077c-11.815385 11.815385-11.815385 29.538462 0 41.353846l41.353846 41.353846c11.815385 11.815385 29.538462 11.815385 41.353846 0L498.215385 610.461538c7.876923-7.876923 19.692308-7.876923 27.56923 0l257.969231 257.969231c11.815385 11.815385 29.538462 11.815385 41.353846 0L866.461538 827.076923c11.815385-11.815385 11.815385-29.538462 0-41.353846L610.461538 527.753846c-7.876923-7.876923-7.876923-19.692308 0-27.569231z"},null)])]),l.value.loading&&((x=t.loading)==null?void 0:x.call(t))])])}}}),Z=(n,{emit:t})=>e.createVNode("svg",{style:{width:"18px",height:"18px",display:"inline-block",transform:n.expanded?"rotate(90deg)":""},viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg",onClick:()=>t("onClick")},[e.createVNode("path",{fill:"currentColor",d:"M384 192v640l384-320.064z"},null)]),fe="",ee={data:{type:Array,default:[]},itemHeight:{type:Number,default:22},component:{type:String,default:"div"}},ge="",te=e.defineComponent({name:"SVirtualList",props:ee,setup(n,{slots:t}){const{data:o,itemHeight:r,component:l}=e.toRefs(n),a=e.ref(),d=e.ref(0),c=e.ref(0),i=e.ref(0),u=e.computed(()=>Math.ceil(d.value/r.value)),s=e.computed(()=>o.value.slice(i.value,Math.min(i.value+u.value,o.value.length)));e.onMounted(()=>{var b;d.value=(b=a.value)==null?void 0:b.clientHeight});const m=b=>{const{scrollTop:I}=b.target;i.value=Math.floor(I/r.value),c.value=I-I%r.value};return()=>e.createVNode(l.value,{class:"s-virtual-list__container",ref:a,onScroll:m},{default:()=>[e.createVNode("div",{class:"s-virtual-list__blank",style:{height:`${o.value.length*r.value}px`}},null),e.createVNode("div",{class:"s-virtual-list",style:{transform:`translate3d(0, ${c.value}px, 0)`}},[s.value.map((b,I)=>{var k;return(k=t.default)==null?void 0:k.call(t,{item:b,index:I})})])]})}}),L=e.defineComponent({name:"STree",props:O,emits:["lazy-load"],setup(n,t){const{data:o,height:r,itemHeight:l}=e.toRefs(n),{slots:a}=t,d=Q(o,n,t);return e.provide("TREE_UTILS",d),()=>{const c=i=>e.createVNode(X,e.mergeProps(n,{treeNode:i}),{content:()=>a.content?a.content(i):i.label,icon:()=>a.icon?a.icon({nodeData:i,toggleNode:d.toggleNode}):e.createVNode(Z,{expanded:!!i.expanded,onClick:()=>d.toggleNode(i)},null),loading:()=>a.loading?a.loading({nodeData:d}):e.createVNode("span",{class:"ml-1"},[e.createTextVNode("loading...")])});return e.createVNode("div",{class:"s-tree"},[r!=null&&r.value?e.createVNode("div",{style:{height:`${r.value}px`}},[e.createVNode(te,{data:d.expandedTree.value,itemHeight:l.value},{default:({item:i})=>c(i)})]):d.expandedTree.value.map(i=>c(i))])}}}),ne={install(n){n.component(L.name,L)}},A={total:{type:Number,default:0},pageSize:{type:Number,default:10},pagerCount:{type:Number,default:7},modelValue:{type:Number,default:1}},me="";function oe(n=1){const t=e.ref(n),o=d=>{t.value=d},r=d=>{t.value+=d};return{pageIndex:t,setPageIndex:o,jumpPage:r,prevPage:()=>r(-1),nextPage:()=>r(1)}}const le=(n,t,o)=>{const r=Array.from(Array(n).keys());if(n<=o)return r.slice(2,n);{const l=Math.ceil(o/2);return t<=l?r.slice(2,o):t>=n-l+1?r.slice(n-o+2,n):r.slice(t-l+2,t+l-1)}},ae=A,D=e.defineComponent({name:"SPager",props:ae,setup(n){const{total:t,pageSize:o,pagerCount:r}=e.toRefs(n),l=e.computed(()=>Math.ceil(t.value/o.value)),{pageIndex:a,setPageIndex:d,jumpPage:c,prevPage:i,nextPage:u}=oe(),s=e.computed(()=>le(l.value,a.value,r.value));return{totalPage:l,pageIndex:a,setPageIndex:d,jumpPage:c,prevPage:i,nextPage:u,centerPages:s}},render(){const{pagerCount:n,totalPage:t,pageIndex:o,setPageIndex:r,jumpPage:l,centerPages:a}=this;return e.createVNode("ul",{class:"s-pager"},[e.createVNode("li",{onClick:()=>r(1),class:{current:o===1}},[e.createTextVNode("1")]),t>n&&o>Math.ceil(n/2)&&e.createVNode("li",{class:"more left",onClick:()=>l(-5)},[e.createTextVNode("...")]),a.map(d=>e.createVNode("li",{onClick:()=>r(d),class:{current:o===d}},[d])),t>n&&o<t-Math.ceil(n/2)+1&&e.createVNode("li",{class:"more right",onClick:()=>l(5)},[e.createTextVNode("...")]),t>1&&e.createVNode("li",{onClick:()=>r(t),class:{current:o===t}},[t])])}}),z=e.defineComponent({name:"SPagination",props:A,emits:["update:modelValue"],setup(n,{emit:t}){const o=e.ref(),r=e.computed(()=>o.value?o.value.pageIndex<2:!0),l=e.computed(()=>o.value?o.value.pageIndex>o.value.totalPage-1:!0);return e.onMounted(()=>{e.watch(()=>o.value.pageIndex,a=>{t("update:modelValue",a)}),e.watch(()=>n.modelValue,a=>{o.value.pageIndex=a})}),()=>e.createVNode("div",{class:"s-pagination"},[e.createVNode("button",{disabled:r.value,onClick:()=>o.value.prevPage()},[e.createTextVNode("上一页")]),e.createVNode(D,e.mergeProps(n,{ref:o}),null),e.createVNode("button",{disabled:l.value,onClick:()=>o.value.nextPage()},[e.createTextVNode("下一页")])])}}),re={install(n){n.component(z.name,z),n.component(D.name,D)}},ce={model:{type:Object,required:!0},layout:{type:String,default:"horizontal"},labelSize:{type:String,default:"md"},labelAlign:{type:String,default:"start"}},he="",E=e.defineComponent({name:"SForm",props:ce,setup(n,{slots:t}){const o=e.computed(()=>({layout:n.layout,labelSize:n.labelSize,labelAlign:n.labelAlign}));return e.provide("LABEL_DATA",o),()=>{var r;return e.createVNode("div",{class:"s-form"},[(r=t.default)==null?void 0:r.call(t)])}}}),de={label:{type:String}},ve="",j=e.defineComponent({name:"SFormItem",props:de,setup(n,{slots:t}){const o=e.inject("LABEL_DATA"),r=e.computed(()=>({"s-form__item":!0,"s-form__item--horizontal":o.value.layout==="horizontal","s-form__item--vertical":o.value.layout==="vertical"})),l=e.computed(()=>({"s-form__label":!0,"s-form__label--vertical":o.value.layout==="vertical",[`s-form__label--${o.value.labelAlign}`]:o.value.layout==="horizontal",[`s-form__label--${o.value.labelSize}`]:o.value.layout==="horizontal"}));return()=>{var a;return e.createVNode("div",{class:r.value},[e.createVNode("span",{class:l.value},[n.label]),e.createVNode("div",null,[(a=t.default)==null?void 0:a.call(t)])])}}}),ie=[R,ne,re,{install(n){n.component(E.name,E),n.component(j.name,j)}}],se={version:"0.0.1",install(n){ie.forEach(t=>n.use(t))}};y.Button=C,y.Form=E,y.Pagination=z,y.Tree=L,y.default=se,Object.defineProperties(y,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
