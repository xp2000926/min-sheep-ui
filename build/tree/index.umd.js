(function(V,e){typeof exports=="object"&&typeof module<"u"?e(exports,require("vue")):typeof define=="function"&&define.amd?define(["exports","vue"],e):(V=typeof globalThis<"u"?globalThis:V||self,e(V.index={},V.Vue))})(this,function(V,e){"use strict";function _(o,l=0,u=[]){return l++,o.reduce((g,a)=>{const r={...a};r.level=l,u.length>0&&u[u.length-1].level>=l&&u.pop(),u.push(r);const d=u[u.length-2];if(d&&(r.parentId=d.id),r.children){const t=_(r.children,l,u);return delete r.children,g.concat(r,t)}else return r.isLeaf===void 0&&(r.isLeaf=!0),g.concat(r)},[])}function O(o,{getChildren:l,getParent:u},{emit:g}){const a=d=>{d.checked=!d.checked,l(d).forEach(s=>{s.checked=d.checked,s.inChecked=l(d,!0).every(N=>N.inChecked)}),d.inChecked=!1,r(d);const t=o.value.map(s=>{if(s.checked)return s.id}).filter(Boolean),i=o.value.map(s=>{if(s.checked)return s}).filter(Boolean),n=o.value.map(s=>{if(s.inChecked)return s.id}).filter(Boolean),c=o.value.map(s=>{if(s.inChecked)return s}).filter(Boolean);g("check",d,t,i,n,c)},r=d=>{const t=u(d);if(!t)return;const i=l(t,!0),n=i.every(s=>s.checked);t.checked=n;const c=i.some(s=>s.checked);n?t.inChecked=!1:c?t.inChecked=!0:t.inChecked=!1,t.parentId&&r(t)};return{toggleCheckNode:a}}function M(o){const l=e.computed(()=>{let t=[];const i=[];for(const n of o.value)t.map(c=>c.id).includes(n.id)||(n.expanded!==!0&&(t=u(n)),i.push(n));return i}),u=(t,i=!0)=>{const n=[],c=o.value.findIndex(s=>s.id===t.id);for(let s=c+1;s<o.value.length&&t.level<o.value[s].level;s++)(i||t.level===o.value[s].level-1)&&n.push(o.value[s]);return n},g=(t,i=[])=>{const n=u(t,!1);return i.push(...n),n.forEach(c=>{c.expanded&&g(c,i)}),i};return{expandedTree:l,getChildren:u,getChildrenExpanded:g,getIndex:t=>t?o.value.findIndex(i=>i.id===t.id):-1,getNode:t=>o.value.find(i=>i.id===t.id),getParent:t=>o.value.find(i=>i.id===t.parentId)}}const S={dropPrev:"s-tree__node--drop-prev",dropNext:"s-tree__node--drop-next",dropInner:"s-tree__node--drop-inner"};function H(o,l,{getChildren:u,getParent:g}){const a=e.reactive({dropType:void 0,draggingNode:null,draggingTreeNode:null}),r=e.computed(()=>l.value.reduce((p,f)=>({...p,[f.id]:f}),{})),d=p=>{p==null||p.classList.remove(...Object.values(S))},t=(p,f)=>{var x;const h=(x=r.value[p])==null?void 0:x.parentId;return h===f?!0:h!==void 0?t(h,f):!1},i=()=>{a.dropType=void 0,a.draggingNode=null,a.draggingTreeNode=null},n=(p,f)=>{var h;p.stopPropagation(),a.draggingNode=p.target,a.draggingTreeNode=f,(h=p.dataTransfer)==null||h.setData("dragNodeId",f.id)},c=p=>{if(p.preventDefault(),p.stopPropagation(),!!a.draggingNode&&o){if(p.dataTransfer&&(p.dataTransfer.dropEffect="move"),!l)return;let f={};typeof o=="object"?f=o:o===!0&&(f={dropInner:!0});const{dropPrev:h,dropNext:x,dropInner:C}=f;let v;const b=h?C?.25:x?.45:1:-1,k=x?C?.75:h?.55:0:1,y=p.currentTarget,I=y==null?void 0:y.getBoundingClientRect(),E=p.clientY-((I==null?void 0:I.top)||0);if(E<((I==null?void 0:I.height)||0)*b?v="dropPrev":E>((I==null?void 0:I.height)||0)*k?v="dropNext":C?v="dropInner":v=void 0,v){const B=y==null?void 0:y.classList;B&&(B.contains(S[v])||(d(y),B.add(S[v])))}else d(y);a.dropType=v}},s=p=>{p.stopPropagation(),a.draggingNode&&d(p.currentTarget)},N=(p,f)=>{var x;if(p.preventDefault(),p.stopPropagation(),d(p.currentTarget),!a.draggingNode||!o)return;const h=(x=p.dataTransfer)==null?void 0:x.getData("dragNodeId");if(h){const C=t(f.id,h);if(h===f.id||C)return;a.dropType&&m(h,f),i()}};function m(p,f){const h=l.value.find(x=>x.id===p);if(h){let x;const C=u(h),v=g(h);if(a.dropType==="dropInner"){x={...h,parentId:f.id,level:f.level+1};const b=l.value.indexOf(f);l.value.splice(b+1,0,x),f.isLeaf=void 0;const k=l.value.indexOf(h);l.value.splice(k,1)}else if(a.dropType==="dropNext"){x={...h,parentId:f.parentId,level:f.level};const b=l.value.indexOf(f),k=u(f,!0).length;l.value.splice(b+k+1,0,x);const y=l.value.indexOf(h);l.value.splice(y,1)}else if(a.dropType==="dropPrev"){x={...h,parentId:f.parentId,level:f.level};const b=l.value.indexOf(f);l.value.splice(b,0,x);const k=l.value.indexOf(h);l.value.splice(k,1)}a.dropType="dropInner",C.forEach(b=>m(b.id,x)),v&&u(v).length===0&&(v.isLeaf=!0)}}return{onDragstart:n,onDragover:c,onDragleave:s,onDrop:N,onDragend:p=>{p.preventDefault(),p.stopPropagation(),i()}}}function R(o,{getNode:l,getIndex:u,getChildren:g},{emit:a}){const r=n=>{const c=l(n);c&&c.isLeaf===!1&&!c.childNodeCount&&(c.loading=!0,a("lazy-load",n,d))},d=n=>{const c=l(n.node);if(c){c.loading=!1;const s=e.ref(_(n.treeItems,c.level));t(c,s),i(c,s);const N=g(c);c.childNodeCount=N.length}},t=(n,c)=>{c.value.forEach(s=>{s.level-1===n.level&&!s.parentId&&(s.parentId=n.id)})},i=(n,c)=>{const s=u(n);s&&o.value.splice(s+1,0,...c.value)};return{lazyLoadNodes:r}}function z(o=8){const l="abcdefghijklmnopqrstuvwxyz0123456789";let u="";for(let g=0;g<o;g++)u+=l[parseInt((Math.random()*l.length).toString())];return u}function j(o,{getChildren:l,getIndex:u}){return{append:(r,d)=>{const t=l(r,!1),i=t[t.length-1];let n=u(r)+1;i&&(n=u(i)+1),r.expanded=!0,r.isLeaf=!1;const c=e.ref({...d,level:r.level+1,parentId:r.id,isLeaf:!0});c.value.id===void 0&&(c.value.id=z()),o.value.splice(n,0,c.value)},remove:r=>{const d=l(r).map(t=>t.id);o.value=o.value.filter(t=>t.id!==r.id&&!d.includes(t.id))}}}function $(o,l,u,g){const{lazyLoadNodes:a}=g;return{toggleNode:(d,t,i=!1)=>{if(d.stopPropagation(),i)o.value.forEach(n=>{n.level===t.level&&n.id!==t.id&&(n.expanded=!1),n.id===t.id&&(n.expanded=!n.expanded),n.expanded&&a(n)});else{const n=o.value.find(c=>c.id===t.id);n&&(n.expanded=!n.expanded,n.expanded&&a(n))}}}}function q(o,l,u){const g=e.unref(o),a=e.ref(_(g)),r=M(a),d=[$,O,j],t=R(a,r,u),i=H(l.draggable,a,r);return{...d.reduce((c,s)=>({...c,...s(a,r,u,t)}),{}),...r,...i,treeData:a}}const D={data:{type:Object,required:!0},lineable:{type:Boolean,default:!1},checkable:{type:Boolean,default:!1},operable:{type:Boolean,default:!1},draggable:{type:[Boolean,Object],default:!1},height:{type:Number},itemHeight:{type:Number,default:30},accordion:{type:Boolean,default:!1}},A={onClick:{type:Function,required:!0}},ne="",te="",F=e.defineComponent({name:"SBaseSelectAll",props:A,setup(o){return()=>e.createVNode("label",{class:"s-base-select-all is-checked"},[e.createVNode("span",{class:"s-base-select-all__input is-checked"},[e.createVNode("span",{class:"s-base-select-all__inner"},null),e.createVNode("input",{type:"checkbox","aria-hidden":"false",class:"s-base-select-all__original",value:"",tabindex:"-1",onClick:()=>{o.onClick()}},null)])])}}),K={onClick:{type:Function,required:!0}},le="",U=e.defineComponent({name:"SBaseSelectionBox",props:K,setup(o){return()=>e.createVNode("label",{class:"s-base-selection-box"},[e.createVNode("span",{class:"s-base-selection-box__input"},[e.createVNode("span",{class:"s-base-selection-box__inner"},null),e.createVNode("input",{type:"checkbox","aria-hidden":"false",class:"s-base-selection-box__original",value:"",tabindex:"-1",onClick:()=>{o.onClick()}},null)])])}}),Y={onClick:{type:Function,required:!0}},oe="",G=e.defineComponent({name:"SBaseSemiSelection",props:Y,setup(o){return()=>e.createVNode("label",{class:"s-base-semi-selection","aria-controls":"undefined"},[e.createVNode("span",{class:"s-base-semi-selection__input is-indeterminate",tabindex:"0",role:"checkbox","aria-checked":"mixed"},[e.createVNode("span",{class:"s-base-semi-selection__inner"},null),e.createVNode("input",{type:"checkbox","aria-hidden":"true",class:"s-base-semi-selection__original",value:"",tabindex:"-1",onClick:()=>{o.onClick()}},null)])])}}),J={...D,treeNode:{type:Object,required:!0}},P=34,w=24,Q=e.defineComponent({name:"STreeNode",props:J,setup(o,{slots:l}){const{lineable:u,checkable:g,treeNode:a,operable:r,draggable:d}=e.toRefs(o),{toggleCheckNode:t,getChildrenExpanded:i,append:n,remove:c,onDragend:s,onDragleave:N,onDragover:m,onDragstart:T,onDrop:p}=e.inject("TREE_UTILS"),f=e.ref(!1),h=()=>{f.value?f.value=!1:f.value=!0};let x={};d.value&&(x={draggable:!0,onDragend:v=>s(v),onDragleave:v=>N(v),onDragover:v=>m(v),onDragstart:v=>T(v,a.value),onDrop:v=>p(v,a.value)});const C=()=>e.createVNode(e.Fragment,null,[a.value.inChecked?e.createVNode(G,{onClick:()=>t(a.value)},null):a.value.checked?e.createVNode(F,{onClick:()=>t(a.value)},null):e.createVNode(U,{onClick:()=>t(a.value)},null)]);return()=>{var v,b,k;return e.createVNode("div",{class:"s-tree__node hover:bg-slate-300 relative leading-8",style:{paddingLeft:`${w*(a.value.level-1)}px`},onMouseenter:h,onMouseleave:h},[!a.value.isLeaf&&a.value.expanded&&u.value&&e.createVNode("span",{class:"s-tree-node__vline absolute w-px bg-slate-300",style:{height:`${P*i(a.value).length}px`,left:`${w*(a.value.level-1)+9}px`,top:`${P}px`}},null),e.createVNode("div",e.mergeProps({class:"s-tree__node--content"},x),[a.value.isLeaf?e.createVNode("span",{style:{display:"inline-block",width:"18px"}},null):(v=l.icon)==null?void 0:v.call(l),g.value&&C(),(b=l.content)==null?void 0:b.call(l),r.value&&f.value&&e.createVNode("span",{class:"inline-flex ml-1"},[e.createVNode("svg",{onClick:()=>{n(a.value,{label:"新节点"})},viewBox:"0 0 1024 1024",width:"14",height:"14",class:"cursor-pointer"},[e.createVNode("path",{d:"M590.769231 571.076923h324.923077c15.753846 0 29.538462-13.784615 29.538461-29.538461v-59.076924c0-15.753846-13.784615-29.538462-29.538461-29.538461H590.769231c-11.815385 0-19.692308-7.876923-19.692308-19.692308V108.307692c0-15.753846-13.784615-29.538462-29.538461-29.538461h-59.076924c-15.753846 0-29.538462 13.784615-29.538461 29.538461V433.230769c0 11.815385-7.876923 19.692308-19.692308 19.692308H108.307692c-15.753846 0-29.538462 13.784615-29.538461 29.538461v59.076924c0 15.753846 13.784615 29.538462 29.538461 29.538461H433.230769c11.815385 0 19.692308 7.876923 19.692308 19.692308v324.923077c0 15.753846 13.784615 29.538462 29.538461 29.538461h59.076924c15.753846 0 29.538462-13.784615 29.538461-29.538461V590.769231c0-11.815385 7.876923-19.692308 19.692308-19.692308z"},null)]),e.createVNode("svg",{onClick:()=>{c(a.value)},viewBox:"0 0 1024 1024",width:"14",height:"14",class:"cursor-pointer ml-1"},[e.createVNode("path",{d:"M610.461538 500.184615l256-257.96923c11.815385-11.815385 11.815385-29.538462 0-41.353847l-39.384615-41.353846c-11.815385-11.815385-29.538462-11.815385-41.353846 0L527.753846 417.476923c-7.876923 7.876923-19.692308 7.876923-27.569231 0L242.215385 157.538462c-11.815385-11.815385-29.538462-11.815385-41.353847 0l-41.353846 41.353846c-11.815385 11.815385-11.815385 29.538462 0 41.353846l257.969231 257.969231c7.876923 7.876923 7.876923 19.692308 0 27.56923L157.538462 785.723077c-11.815385 11.815385-11.815385 29.538462 0 41.353846l41.353846 41.353846c11.815385 11.815385 29.538462 11.815385 41.353846 0L498.215385 610.461538c7.876923-7.876923 19.692308-7.876923 27.56923 0l257.969231 257.969231c11.815385 11.815385 29.538462 11.815385 41.353846 0L866.461538 827.076923c11.815385-11.815385 11.815385-29.538462 0-41.353846L610.461538 527.753846c-7.876923-7.876923-7.876923-19.692308 0-27.569231z"},null)])]),a.value.loading&&((k=l.loading)==null?void 0:k.call(l))])])}}}),W=(o,{emit:l})=>e.createVNode("svg",{style:{width:"18px",height:"18px",display:"inline-block",transform:o.expanded?"rotate(90deg)":""},viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg",onClick:()=>l("onClick")},[e.createVNode("path",{fill:"currentColor",d:"M384 192v640l384-320.064z"},null)]),ae="",X={data:{type:Array,default:[]},itemHeight:{type:Number,default:22},component:{type:String,default:"div"}},ce="",Z=e.defineComponent({name:"SVirtualList",props:X,setup(o,{slots:l}){const{data:u,itemHeight:g,component:a}=e.toRefs(o),r=e.ref(),d=e.ref(0),t=e.ref(0),i=e.ref(0),n=e.computed(()=>Math.ceil(d.value/g.value)),c=e.computed(()=>u.value.slice(i.value,Math.min(i.value+n.value,u.value.length)));e.onMounted(()=>{var N;d.value=(N=r.value)==null?void 0:N.clientHeight});const s=N=>{const{scrollTop:m}=N.target;i.value=Math.floor(m/g.value),t.value=m-m%g.value};return()=>e.createVNode(a.value,{class:"s-virtual-list__container",ref:r,onScroll:s},{default:()=>[e.createVNode("div",{class:"s-virtual-list__blank",style:{height:`${u.value.length*g.value}px`}},null),e.createVNode("div",{class:"s-virtual-list",style:{transform:`translate3d(0, ${t.value}px, 0)`}},[c.value.map((N,m)=>{var T;return(T=l.default)==null?void 0:T.call(l,{item:N,index:m})})])]})}}),L=e.defineComponent({name:"STree",props:D,emits:["lazy-load","check"],setup(o,l){const{data:u,height:g,itemHeight:a,accordion:r}=e.toRefs(o),{slots:d}=l,t=q(u,o,l);return e.provide("TREE_UTILS",t),()=>{const i=n=>e.createVNode(Q,e.mergeProps(o,{treeNode:n,onClick:r.value?c=>t.toggleNode(c,n,r.value):""}),{content:()=>d.content?d.content(n):n.label,icon:()=>d.icon?d.icon({nodeData:n,toggleNode:t.toggleNode}):e.createVNode(W,{expanded:!!n.expanded,onClick:c=>t.toggleNode(c,n,r.value)},null),loading:()=>d.loading?d.loading({nodeData:t}):e.createVNode("span",{class:"ml-1"},[e.createTextVNode("loading...")])});return e.createVNode("div",{class:"s-tree"},[g!=null&&g.value?e.createVNode("div",{style:{height:`${g.value}px`}},[e.createVNode(Z,{data:t.expandedTree.value,itemHeight:a.value},{default:({item:n})=>i(n)})]):t.expandedTree.value.map(n=>i(n))])}}}),ee={install(o){o.component(L.name,L)}};V.Tree=L,V.default=ee,Object.defineProperties(V,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
